
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Nano Tutorial 1 - a Number Conversion Sample - Abstraction Builder</title>
  <meta name="author" content="Bulldog">

  
  <meta name="description" content="Nano Tutorial Series 1 - a Number Conversion Sample">
  <meta name="keywords" content="wsdl, soap, android, java">

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://bulldog2011.github.com/blog/2013/04/15/nano-tutorial-1-a-number-conversion-sample/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Abstraction Builder" type="application/atom+xml">
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <div id="logo">
  	<div id="logoLeft">{</div>
  	<div id="logoText">ab</div>
  	<div id="logoRight">}</div>
  	<div class="clear"></div>
  </div>
  <h1><a href="/">Abstraction Builder</a></h1>
  
    <h2>Building simple and elegant programming abstractions</h2>
  
  <div class="clear"></div>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:bulldog2011.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/projects">Projects</a></li>
  <li><a href="/lab">Lab</a></li>
  <li><a href="/about">About Me</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      
        <h1 class="entry-title">Nano Tutorial 1 - a Number Conversion Sample</h1>
      
    
    
      <p class="meta">
        








  


<time datetime="2013-04-15T20:14:00+08:00" pubdate data-updated="true">Apr 15<span>th</span>, 2013</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>This is the first post of Nano Tutorial Series, in this post, I will show you how easy to use <a href="https://github.com/bulldog2011/nano">Nano framework</a> to put WSDL driven application development on Android platform into practice. If this is the first time you get to know Nano, then after this tutorial, you will basically understand what Nano can do for you, and the basic development process when using Nano to carry out WSDL driven development on Android. If you want to see the big picture, please read <a href="http://bulldog2011.github.io/blog/2013/04/15/wsdl-driven-development-on-android-the-big-picture/">this post</a> first.</p>

<p>The whole source of this demo is <a href="https://github.com/bulldog2011/nano/tree/master/sample/webservice/NumberConverter">here</a>.</p>

<p>WSDL driven development using Nano framework has following steps:</p>

<blockquote><ol>
<li>Generate Java proxy from WSDL</li>
<li>Create new Android project, add Nano runtime and generated proxy into your project</li>
<li>Implement appliction logic and UI, call proxy to invoke web service as needed.</li>
</ol>
</blockquote>

<p>Let me cut to the point and show you each step using a simple <a href="http://www.dataaccess.com/webservicesserver/numberconversion.wso">Number Conversion</a> web serivce from <a href="http://www.dataaccess.com/">Data Access Worldwide</a>.</p>

<!--more-->


<h2>Step 1 - Generate Java Proxy from WSDL</h2>

<p>Nano has an accompanying code generator which can generate Java proxy for Android from wsdl, the tool is called <a href="https://github.com/bulldog2011/mwsc">mwsc</a>, please download the latest zip package <a href="https://github.com/bulldog2011/bulldog-repo/blob/master/repo/releases/com/leansoft/mwsc/0.6.0/mwsc-0.6.0-bin.zip">here</a> then extract it into your local folder.
<strong><em>Note</em></strong> : mwsc code generator needs Java 1.6 or above to run, so please ensure Java is installed on your OS, if not, please install it first.</p>

<p>The command line script <code>mwsc.bat</code> is in the bin folder, note, <code>mwsc.bat</code> is for windows, for linux, please use <code>mwsc</code> in the same folder. Before code generation, you may optionally create a folder as your code generation target(for example, <code>generated</code>), otherwise, mwsc will generate code in current folder. Now let&#8217;s generate code from wsdl by running flowing command in the terminal:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>bin\mwsc.bat -nano -d generated http://www.dataaccess.com/webservicesserver/numberconversion.wso?WSDL</span></code></pre></td></tr></table></div></figure>


<p>If everything works fine, you will see the code generator output <code>generating codeâ€¦</code> and <code>done</code> at the end, the target proxy will be generated in the <code>generated</code> folder.</p>

<h2>Step 2 - Create New Android Project, Add Nano Library and Generated Proxy into Your Project</h2>

<p>Now let&#8217;s create a simple Android project in eclipse(or other IDE you prefer), then you need to:</p>

<blockquote><ol>
<li>Download <a href="https://github.com/bulldog2011/bulldog-repo/blob/master/repo/releases/com/leansoft/nano/0.7.0/nano-0.7.0.jar">latest nano library jar</a> and add it to the <code>libs</code> folder of your Android project.</li>
<li>Drag the above generated proxy into the <code>src</code> folder of your Android project.</li>
<li>Add following user permissions in the <code>AndroidManifest.xml</code> file to enable network access.</li>
</ol>
</blockquote>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.INTERNET&quot;</span> <span class="nt">/&gt;</span>
</span><span class='line'><span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.ACCESS_NETWORK_STATE&quot;</span> <span class="nt">/&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now since both Nano runtime library and the NumberConversion web service proxy have been added in the project, you can try to refresh(or build) the project, if no build error, job well done, you can continue to the next step, otherwise, please do some troubleshooting, or check the source of this tutorial(in the sample/webservice folder).</p>

<p>Below is an eclipse package explorer screenshot after finishing this step:</p>

<p><img class="center" src="/images/nano/tutorial01/screen_shot1.png" width="600" height="800"></p>

<h2>Step 3 - Implement Appliction Logic and UI, Call Proxy to Invoke Web Service as Needed.</h2>

<p>A SOAP web service client called <code>NumberConversionSoapType_SOAPClient</code> has been generated in the <code>com.dataaccess.webservicesserver.client</code> package, it&#8217;s the main proxy to the external number conversion service, you can invoke number conversion service by calling methods on a <code>NumberConversionSoapType_SOAPClient</code> instance. As a Nano best practice, it&#8217;s not necessary for you to initiate a new client everytime you need to call service, a singleton client instance is enough for the whole application, so before writing any application logic, let&#8217;s create a shared NumberConversion service client for later use first, see code below:</p>

<figure class='code'><figcaption><span>NumberConversionServiceClient.java </span><a href='https://github.com/bulldog2011/nano/blob/master/sample/webservice/NumberConverter/src/com/dataaccess/service/NumberConversionServiceClient.java'>source </a></figcaption> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">dataaccess</span><span class="o">.</span><span class="na">service</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'><span class="kn">import</span> <span class="nn">com.dataaccess.webservicesserver.client.NumberConversionSoapType_SOAPClient</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'><span class="cm">/**</span>
</span><span class='line'><span class="cm"> * The Number Conversion Web Service, implemented with Visual DataFlex, </span>
</span><span class='line'><span class="cm"> * provides functions that convert numbers into words or dollar amounts.</span>
</span><span class='line'><span class="cm"> * </span>
</span><span class='line'><span class="cm"> * http://www.dataaccess.com/webservicesserver/numberconversion.wso</span>
</span><span class='line'><span class="cm"> * </span>
</span><span class='line'><span class="cm"> * @author bulldog</span>
</span><span class='line'><span class="cm"> *</span>
</span><span class='line'><span class="cm"> */</span>
</span><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">NumberConversionServiceClient</span> <span class="o">{</span>
</span><span class='line'>  
</span><span class='line'>  <span class="c1">// target endpoint</span>
</span><span class='line'>  <span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">numberConversionServiceUrl</span> <span class="o">=</span> <span class="s">&quot;http://www.dataaccess.com/webservicesserver/numberconversion.wso&quot;</span><span class="o">;</span>
</span><span class='line'>  
</span><span class='line'>  <span class="kd">private</span> <span class="kd">static</span> <span class="kd">volatile</span> <span class="n">NumberConversionSoapType_SOAPClient</span> <span class="n">client</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
</span><span class='line'>  
</span><span class='line'>  <span class="c1">// get a shared client</span>
</span><span class='line'>  <span class="kd">public</span> <span class="kd">static</span> <span class="n">NumberConversionSoapType_SOAPClient</span> <span class="nf">getSharedClient</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="o">(</span><span class="n">client</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>          <span class="kd">synchronized</span><span class="o">(</span><span class="n">NumberConversionServiceClient</span><span class="o">.</span><span class="na">class</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>              <span class="k">if</span> <span class="o">(</span><span class="n">client</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>                  <span class="n">client</span> <span class="o">=</span> <span class="k">new</span> <span class="n">NumberConversionSoapType_SOAPClient</span><span class="o">();</span>
</span><span class='line'>                  <span class="n">client</span><span class="o">.</span><span class="na">setEndpointUrl</span><span class="o">(</span><span class="n">numberConversionServiceUrl</span><span class="o">);</span>
</span><span class='line'>              <span class="o">}</span>
</span><span class='line'>          <span class="o">}</span>
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>      
</span><span class='line'>      <span class="k">return</span> <span class="n">client</span><span class="o">;</span>
</span><span class='line'>  <span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The code is quite self-explanatory, the <code>getSharedClient</code> static factory method just returns a NumberConversionSoapType_SOAPClient instance with specified target service endpoint address, and there will be only one such client instance within the application.</p>

<p>With the help of the NumberConversion service proxy generated from WSDL, web service call through Nano is extremely simple, let&#8217;s review and understand the generated numberToWords proxy interface first before writing calling logic:</p>

<figure class='code'><figcaption><span>NumberConversionSoapType_SOAPClient.java </span><a href='https://github.com/bulldog2011/nano/blob/master/sample/webservice/NumberConverter/src/com/dataaccess/webservicesserver/client/NumberConversionSoapType_SOAPClient.java'>source  </a></figcaption> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="c1">// Generated by wsdl compiler for android/java</span>
</span><span class='line'><span class="c1">// DO NOT CHANGE!</span>
</span><span class='line'><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">dataaccess</span><span class="o">.</span><span class="na">webservicesserver</span><span class="o">.</span><span class="na">client</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="kn">import</span> <span class="nn">com.leansoft.nano.ws.SOAPServiceCallback</span><span class="o">;</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">com.leansoft.nano.ws.NanoSOAPClient</span><span class="o">;</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">com.dataaccess.webservicesserver.NumberToDollars</span><span class="o">;</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">com.dataaccess.webservicesserver.NumberToWords</span><span class="o">;</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">com.dataaccess.webservicesserver.NumberToWordsResponse</span><span class="o">;</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">com.dataaccess.webservicesserver.NumberToDollarsResponse</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="cm">/**</span>
</span><span class='line'><span class="cm"> This class is the SOAP client to the NumberConversionSoapType Web Service.</span>
</span><span class='line'><span class="cm">*/</span>
</span><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">NumberConversionSoapType_SOAPClient</span> <span class="kd">extends</span> <span class="n">NanoSOAPClient</span> <span class="o">{</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    <span class="cm">/**</span>
</span><span class='line'><span class="cm">     Returns the word corresponding to the positive number passed as parameter. Limited to quadrillions.</span>
</span><span class='line'><span class="cm">    */</span>
</span><span class='line'>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">numberToWords</span><span class="o">(</span><span class="n">NumberToWords</span> <span class="n">requestObject</span><span class="o">,</span> <span class="n">SOAPServiceCallback</span><span class="o">&lt;</span><span class="n">NumberToWordsResponse</span><span class="o">&gt;</span> <span class="n">serviceCallback</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>        <span class="kd">super</span><span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">requestObject</span><span class="o">,</span> <span class="n">serviceCallback</span><span class="o">,</span> <span class="n">NumberToWordsResponse</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="cm">/**</span>
</span><span class='line'><span class="cm">     Returns the non-zero dollar amount of the passed number.</span>
</span><span class='line'><span class="cm">    */</span>
</span><span class='line'>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">numberToDollars</span><span class="o">(</span><span class="n">NumberToDollars</span> <span class="n">requestObject</span><span class="o">,</span> <span class="n">SOAPServiceCallback</span><span class="o">&lt;</span><span class="n">NumberToDollarsResponse</span><span class="o">&gt;</span> <span class="n">serviceCallback</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>        <span class="kd">super</span><span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">requestObject</span><span class="o">,</span> <span class="n">serviceCallback</span><span class="o">,</span> <span class="n">NumberToDollarsResponse</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>This is just a plain old interface generated from wsdl, unlike normal interface, this interface is asynchronous, when you call <code>numberToWords</code> service, you need to provide a request of type <code>NumberToWords</code> as first parameter, also you need to provide(or register) a callback implementing interface <code>SOAPServiceCallback</code>, see definition of this interface below:</p>

<figure class='code'><figcaption><span>XMLServiceCallback.java </span><a href='https://github.com/bulldog2011/nano/blob/master/src/main/java/com/leansoft/nano/ws/XMLServiceCallback.java'>source  </a></figcaption> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">leansoft</span><span class="o">.</span><span class="na">nano</span><span class="o">.</span><span class="na">ws</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">XMLServiceCallback</span><span class="o">&lt;</span><span class="n">R</span><span class="o">&gt;</span> <span class="o">{</span>
</span><span class='line'>  
</span><span class='line'>  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSuccess</span><span class="o">(</span><span class="n">R</span> <span class="n">responseObject</span><span class="o">);</span>
</span><span class='line'>  
</span><span class='line'>  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onFailure</span><span class="o">(</span><span class="n">Throwable</span> <span class="n">error</span><span class="o">,</span> <span class="n">String</span> <span class="n">errorMessage</span><span class="o">);</span>
</span><span class='line'>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>SOAPServiceCallback.java </span><a href='https://github.com/bulldog2011/nano/blob/master/src/main/java/com/leansoft/nano/ws/SOAPServiceCallback.java'>source  </a></figcaption> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">leansoft</span><span class="o">.</span><span class="na">nano</span><span class="o">.</span><span class="na">ws</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">SOAPServiceCallback</span><span class="o">&lt;</span><span class="n">R</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">XMLServiceCallback</span><span class="o">&lt;</span><span class="n">R</span><span class="o">&gt;</span> <span class="o">{</span>
</span><span class='line'>  
</span><span class='line'>  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSOAPFault</span><span class="o">(</span><span class="n">Object</span> <span class="n">soapFault</span><span class="o">);</span>
</span><span class='line'>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>SOAPServiceCallback</code> interface supports three callback methods, <code>onSuccess</code>, <code>onFailure</code> and <code>onSOAPFault</code> callbacks, success callback will be called if the service invocation succeed, and you will get a response object of type <code>NumberToWordsResponse</code>, usually, in success callback, you implement response handling logic and update UI according to the response; failure callback will be called if there is any HTTP or Nano parsing error, you may get an exception and an error message in such case, usually, you implement error handling logic in failure callback and update UI accordingly; soap fault callback will be called if Nano get a SOAP fault from service response, usually, you implement error handling logic in the soap fault callback and update UI accordingly.</p>

<p>By the way, although not necessary, I suggest you to review all proxy code generated by mwsc, this will help you better understand the inner working of Nano.</p>

<p>Now time to the UI part, for this simple demo, we only need an <code>EditText</code> for number input, and two <code>Button</code>, one for number to dollars conversion, the other for number to words conversion, see graphical layout screenshot below:</p>

<p><img class="center" src="/images/nano/tutorial01/screen_shot2.png" width="400" height="600"></p>

<p>Now let&#8217;s implement application logic by calling the <code>numberToWords</code> or <code>numberToDollars</code> services,
the application logic is implemented in the <code>MainActivity</code> class, a registered <code>onClick</code> method will be triggered when you click the <code>Number To Words</code> button on the UI:</p>

<figure class='code'><figcaption><span>MainActivity.m </span><a href='https://github.com/bulldog2011/nano/blob/master/sample/webservice/NumberConverter/src/com/leansoft/nano/sample/MainActivity.java'>source  </a></figcaption> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'> <span class="n">Button</span> <span class="n">numberToWordsButton</span> <span class="o">=</span> <span class="o">(</span><span class="n">Button</span><span class="o">)</span> <span class="k">this</span><span class="o">.</span><span class="na">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">numToWordsButton</span><span class="o">);</span>
</span><span class='line'>  
</span><span class='line'>  <span class="n">numberToWordsButton</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">new</span> <span class="n">OnClickListener</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>
</span><span class='line'>      <span class="nd">@Override</span>
</span><span class='line'>      <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="n">View</span> <span class="n">arg0</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>          <span class="c1">// get shared client</span>
</span><span class='line'>          <span class="n">NumberConversionSoapType_SOAPClient</span> <span class="n">client</span> <span class="o">=</span> <span class="n">NumberConversionServiceClient</span><span class="o">.</span><span class="na">getSharedClient</span><span class="o">();</span>
</span><span class='line'>          <span class="n">client</span><span class="o">.</span><span class="na">setDebug</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span> <span class="c1">// enable soap message logging</span>
</span><span class='line'>          
</span><span class='line'>          <span class="c1">// build request</span>
</span><span class='line'>          <span class="n">NumberToWords</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="n">NumberToWords</span><span class="o">();</span>
</span><span class='line'>          <span class="k">try</span> <span class="o">{</span>
</span><span class='line'>              <span class="n">String</span> <span class="n">number</span> <span class="o">=</span> <span class="o">((</span><span class="n">EditText</span><span class="o">)</span><span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">numerInputText</span><span class="o">)).</span><span class="na">getText</span><span class="o">().</span><span class="na">toString</span><span class="o">();</span>
</span><span class='line'>              <span class="n">request</span><span class="o">.</span><span class="na">ubiNum</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BigInteger</span><span class="o">(</span><span class="n">number</span><span class="o">);</span>
</span><span class='line'>          <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">NumberFormatException</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>              <span class="n">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="n">MainActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="s">&quot;Invalid integer number&quot;</span><span class="o">,</span> <span class="n">Toast</span><span class="o">.</span><span class="na">LENGTH_LONG</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
</span><span class='line'>              <span class="k">return</span><span class="o">;</span>
</span><span class='line'>          <span class="o">}</span>
</span><span class='line'>          
</span><span class='line'>          <span class="c1">// make API call and register callbacks</span>
</span><span class='line'>          <span class="n">client</span><span class="o">.</span><span class="na">numberToWords</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="k">new</span> <span class="n">SOAPServiceCallback</span><span class="o">&lt;</span><span class="n">NumberToWordsResponse</span><span class="o">&gt;()</span> <span class="o">{</span>
</span><span class='line'>
</span><span class='line'>              <span class="nd">@Override</span>
</span><span class='line'>              <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSuccess</span><span class="o">(</span><span class="n">NumberToWordsResponse</span> <span class="n">responseObject</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// success</span>
</span><span class='line'>                  <span class="n">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="n">MainActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="n">responseObject</span><span class="o">.</span><span class="na">numberToWordsResult</span><span class="o">,</span> <span class="n">Toast</span><span class="o">.</span><span class="na">LENGTH_LONG</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
</span><span class='line'>              <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>              <span class="nd">@Override</span>
</span><span class='line'>              <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onFailure</span><span class="o">(</span><span class="n">Throwable</span> <span class="n">error</span><span class="o">,</span> <span class="n">String</span> <span class="n">errorMessage</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// http or parsing error</span>
</span><span class='line'>                  <span class="n">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="n">MainActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="n">errorMessage</span><span class="o">,</span> <span class="n">Toast</span><span class="o">.</span><span class="na">LENGTH_LONG</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
</span><span class='line'>              <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>              <span class="nd">@Override</span>
</span><span class='line'>              <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSOAPFault</span><span class="o">(</span><span class="n">Object</span> <span class="n">soapFault</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// soap fault</span>
</span><span class='line'>                  <span class="n">Fault</span> <span class="n">fault</span> <span class="o">=</span> <span class="o">(</span><span class="n">Fault</span><span class="o">)</span><span class="n">soapFault</span><span class="o">;</span>
</span><span class='line'>                  <span class="n">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="n">MainActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="n">fault</span><span class="o">.</span><span class="na">faultstring</span><span class="o">,</span> <span class="n">Toast</span><span class="o">.</span><span class="na">LENGTH_LONG</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
</span><span class='line'>              <span class="o">}</span>
</span><span class='line'>              
</span><span class='line'>          <span class="o">});</span>
</span><span class='line'>          
</span><span class='line'>      <span class="o">}</span>
</span><span class='line'>      
</span><span class='line'>  <span class="o">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>The call logic can&#8217;t be simpler, I&#8217;ve added comments in the service call code for you to better understand the call flow. Also, I&#8217;ve enabled the debug mode of the proxy, so you can see the detailed request/response messages when you run the demo, this feature is extremely useful for troubleshooting.</p>

<h2>Final Step - Run the Demo</h2>

<p>Now it&#8217;s time to run the demo, let&#8217;s try it in the simulator(you may use a real device of course),  below is a screenshot of the simulator after converting a number to dollars:</p>

<p><img class="center" src="/images/nano/tutorial01/screen_shot3.png" width="400" height="600"></p>

<p>You can also find the debug output in the Android LogCat, like below:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>04-15 13:54:26.146: D/NanoSOAPClient(281): Sending request to : http://www.dataaccess.com/webservicesserver/numberconversion.wso
</span><span class='line'>04-15 13:54:26.146: D/NanoSOAPClient(281): Request HTTP headers : 
</span><span class='line'>04-15 13:54:26.146: D/NanoSOAPClient(281): {
</span><span class='line'>04-15 13:54:26.146: D/NanoSOAPClient(281):     Accept="text/xml"
</span><span class='line'>04-15 13:54:26.146: D/NanoSOAPClient(281): }
</span><span class='line'>04-15 13:54:26.146: D/NanoSOAPClient(281): Request message : 
</span><span class='line'>04-15 13:54:26.146: D/NanoSOAPClient(281): &lt;?xml version='1.0' encoding='UTF-8' ?>
</span><span class='line'>04-15 13:54:26.146: D/NanoSOAPClient(281): &lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.dataaccess.com/webservicesserver/">
</span><span class='line'>04-15 13:54:26.146: D/NanoSOAPClient(281):   &lt;soapenv:Body>
</span><span class='line'>04-15 13:54:26.146: D/NanoSOAPClient(281):     &lt;NumberToDollars>
</span><span class='line'>04-15 13:54:26.146: D/NanoSOAPClient(281):       &lt;dNum>128.32&lt;/dNum>
</span><span class='line'>04-15 13:54:26.146: D/NanoSOAPClient(281):     &lt;/NumberToDollars>
</span><span class='line'>04-15 13:54:26.146: D/NanoSOAPClient(281):   &lt;/soapenv:Body>
</span><span class='line'>04-15 13:54:26.146: D/NanoSOAPClient(281): &lt;/soapenv:Envelope>
</span><span class='line'>04-15 13:54:27.356: D/SOAPHttpResponseHandler(281): Response HTTP status : 200
</span><span class='line'>04-15 13:54:27.366: D/SOAPHttpResponseHandler(281): Response HTTP headers : 
</span><span class='line'>04-15 13:54:27.366: D/SOAPHttpResponseHandler(281): {
</span><span class='line'>04-15 13:54:27.366: D/SOAPHttpResponseHandler(281):     Web-Service="Visual DataFlex 17.0"
</span><span class='line'>04-15 13:54:27.366: D/SOAPHttpResponseHandler(281):     Content-Type="text/xml; charset=utf-8"
</span><span class='line'>04-15 13:54:27.366: D/SOAPHttpResponseHandler(281):     Date="Mon, 15 Apr 2013 13:54:52 GMT"
</span><span class='line'>04-15 13:54:27.366: D/SOAPHttpResponseHandler(281):     Content-Length="397"
</span><span class='line'>04-15 13:54:27.366: D/SOAPHttpResponseHandler(281):     X-Powered-By="ASP.NET"
</span><span class='line'>04-15 13:54:27.366: D/SOAPHttpResponseHandler(281):     Server="Microsoft-IIS/6.0"
</span><span class='line'>04-15 13:54:27.366: D/SOAPHttpResponseHandler(281):     Cache-Control="private, max-age=0"
</span><span class='line'>04-15 13:54:27.366: D/SOAPHttpResponseHandler(281): }
</span><span class='line'>04-15 13:54:27.376: D/SOAPHttpResponseHandler(281): Response message : 
</span><span class='line'>04-15 13:54:27.376: D/SOAPHttpResponseHandler(281): &lt;?xml version="1.0" encoding="utf-8"?>
</span><span class='line'>04-15 13:54:27.376: D/SOAPHttpResponseHandler(281): &lt;soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
</span><span class='line'>04-15 13:54:27.376: D/SOAPHttpResponseHandler(281):   &lt;soap:Body>
</span><span class='line'>04-15 13:54:27.376: D/SOAPHttpResponseHandler(281):     &lt;m:NumberToDollarsResponse xmlns:m="http://www.dataaccess.com/webservicesserver/">
</span><span class='line'>04-15 13:54:27.376: D/SOAPHttpResponseHandler(281):       &lt;m:NumberToDollarsResult>one hundred and twenty eight dollars and thirty two cents&lt;/m:NumberToDollarsResult>
</span><span class='line'>04-15 13:54:27.376: D/SOAPHttpResponseHandler(281):     &lt;/m:NumberToDollarsResponse>
</span><span class='line'>04-15 13:54:27.376: D/SOAPHttpResponseHandler(281):   &lt;/soap:Body>
</span><span class='line'>04-15 13:54:27.376: D/SOAPHttpResponseHandler(281): &lt;/soap:Envelope></span></code></pre></td></tr></table></div></figure>


<p>If you have any problem to run the demo, please check the debug output first.</p>

<p>Now you see the power of Nano framework, you don&#8217;t get troubled with error prone and tedious SOAP/XML parsing or http handling, the generic Nano framework will do these stuff for you, you only need to use a plain old asynchronous interface for service invocation, this can not only accelerate application development, but reduce the long term maintenance cost.</p>

<p>NumberConversion is just a bare minimum demo, there are other more featured demos(like Amazon, eBay search demo) in the sample folder of Nano project, please try them to better understand how Nano works, then you can begin to develop your own service based applications, using wsdl driven methodology supported by Nano.</p>

<p>See your next great Android application!</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Bulldog</span></span>

      








  


<time datetime="2013-04-15T20:14:00+08:00" pubdate data-updated="true">Apr 15<span>th</span>, 2013</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/nano/'>nano</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://bulldog2011.github.com/blog/2013/04/15/nano-tutorial-1-a-number-conversion-sample/" data-via="" data-counturl="http://bulldog2011.github.com/blog/2013/04/15/nano-tutorial-1-a-number-conversion-sample/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left articlenav" href="/blog/2013/04/15/wsdl-driven-development-on-android-the-big-picture/" title="Previous Post: WSDL Driven Development on Android - the Big Picture">&laquo; WSDL Driven Development on Android - the Big Picture</a>
      
      
        <a class="basic-alignment right articlenav" href="/blog/2013/04/17/nano-tutorial-2-a-barcode-sample/" title="Next Post: Nano Tutorial 2 - a BarCode Generator sample">Nano Tutorial 2 - a BarCode Generator sample &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Categories</h1>
  <ul id="categories">
    <li class='category'><a href='/blog/categories/big-queue/'>big queue (7)</a></li>
<li class='category'><a href='/blog/categories/design/'>design (4)</a></li>
<li class='category'><a href='/blog/categories/ebay-api/'>ebay api (2)</a></li>
<li class='category'><a href='/blog/categories/luxun/'>luxun (2)</a></li>
<li class='category'><a href='/blog/categories/misc/'>misc (1)</a></li>
<li class='category'><a href='/blog/categories/nano/'>nano (14)</a></li>
<li class='category'><a href='/blog/categories/pico/'>pico (7)</a></li>

  </ul>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/04/18/nano-tutorial-4-hello-ebay-shopping/">Nano Tutorial 4 - Hello eBay Shopping</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/04/17/nano-tutorial-3-hello-ebay-finding/">Nano Tutorial 3 - Hello eBay Finding</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/04/17/nano-tutorial-2-a-barcode-sample/">Nano Tutorial 2 - a BarCode Generator sample</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/04/15/nano-tutorial-1-a-number-conversion-sample/">Nano Tutorial 1 - a Number Conversion Sample</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/04/15/wsdl-driven-development-on-android-the-big-picture/">WSDL Driven Development on Android - the Big Picture</a>
      </li>
    
  </ul>
</section>






  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Bulldog -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'bulldogtech';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://bulldog2011.github.com/blog/2013/04/15/nano-tutorial-1-a-number-conversion-sample/';
        var disqus_url = 'http://bulldog2011.github.com/blog/2013/04/15/nano-tutorial-1-a-number-conversion-sample/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
